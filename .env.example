# ==============================================================================
# AIRFLOW REMOTE WORKER (KG5090)
# ==============================================================================

# Base image (MUST match prod Airflow version)
AIRFLOW_IMAGE=apache/airflow:2.10.2-python3.11

# ------------------------------------------------------------------------------
# Control Plane Connectivity (same as prod kg-pc)
# ------------------------------------------------------------------------------
# Postgres via Tailscale (kg-pc.tail5c5268.ts.net)
AIRFLOW__DATABASE__SQL_ALCHEMY_CONN=postgresql+psycopg2://airflow:airflow@kg-pc.tail5c5268.ts.net:5432/airflow

# Celery Broker (Railway Redis - DB index /1)
AIRFLOW__CELERY__BROKER_URL=rediss://default:PASSWORD@yamabiko.proxy.rlwy.net:19632/1

# Result Backend (same Postgres)
AIRFLOW__CELERY__RESULT_BACKEND=db+postgresql://airflow:airflow@kg-pc.tail5c5268.ts.net:5432/airflow

# Fernet key (MUST match prod)
AIRFLOW__CORE__FERNET_KEY=your-fernet-key-here

# ------------------------------------------------------------------------------
# Worker Behavior
# ------------------------------------------------------------------------------
WORKER_QUEUES=default
WORKER_CONCURRENCY=8
WORKER_HOSTNAME=kg5090@%h
# WORKER_AUTOSCALE=16,4

# ------------------------------------------------------------------------------
# Celery Serialization (MUST match prod)
# ------------------------------------------------------------------------------
AIRFLOW__CELERY__TASK_SERIALIZER=pickle
AIRFLOW__CELERY__RESULT_SERIALIZER=pickle
AIRFLOW__CELERY__ACCEPT_CONTENT=["pickle","json"]
AIRFLOW__CELERY__WORKER_PREFETCH_MULTIPLIER=1
AIRFLOW__CELERY__BROKER_CONNECTION_RETRY_ON_STARTUP=True

# ------------------------------------------------------------------------------
# DAG/Runtime Secrets (as needed by your tasks)
# ------------------------------------------------------------------------------
OPENAI_API_KEY=sk-...
TIINGO_TOKEN=...
TAVILY_API_KEY=tvly-...
MONGODB_URI=mongodb://...
REDDIT_CLIENT_ID=...
REDDIT_CLIENT_SECRET=...
REDDIT_USER_AGENT=...
UNUSUALWHALES_API_KEY=...
MASSIVE_API_KEY=...
TWITTER_API_KEY=...
