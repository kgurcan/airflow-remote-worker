version: "3.8"

services:
  airflow-worker:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        AIRFLOW_IMAGE: ${AIRFLOW_IMAGE:-apache/airflow:2.10.2-python3.11}
    image: airflow-remote-worker:latest
    container_name: airflow-worker-kg5090
    env_file:
      - .env
    environment:
      WORKER_QUEUES: ${WORKER_QUEUES:-default}
      WORKER_CONCURRENCY: ${WORKER_CONCURRENCY:-8}
      WORKER_HOSTNAME: ${WORKER_HOSTNAME:-kg5090@%h}
      WORKER_AUTOSCALE: ${WORKER_AUTOSCALE:-}
    volumes:
      # Mount DAGs and jobs from airflow-python-jobs repo (Windows Docker path)
      - /c/Users/konur/Documents/fidget_repo/airflow-python-jobs/dags:/opt/airflow/dags:ro
      - /c/Users/konur/Documents/fidget_repo/airflow-python-jobs/jobs:/opt/airflow/jobs:ro
    restart: unless-stopped
