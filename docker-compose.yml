version: "3.8"

services:
  airflow-worker:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        AIRFLOW_IMAGE: ${AIRFLOW_IMAGE:-apache/airflow:2.8.0}
    image: airflow-remote-worker:latest
    container_name: airflow-worker-kg5090
    env_file:
      - .env
    environment:
      WORKER_QUEUES: ${WORKER_QUEUES:-massive_trades}
      WORKER_CONCURRENCY: ${WORKER_CONCURRENCY:-128}
      WORKER_HOSTNAME: ${WORKER_HOSTNAME:-kg5090@%h}
      WORKER_AUTOSCALE: ${WORKER_AUTOSCALE:-}
    volumes:
      - /path/to/dags/on/kg5090:/opt/airflow/dags:ro
      # - /path/to/plugins:/opt/airflow/plugins:ro   # optional
    restart: unless-stopped
